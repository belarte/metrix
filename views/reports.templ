package views

import (
	"fmt"

	"github.com/belarte/metrix/database"
)

func counter(n int) string {
	return fmt.Sprintf("%d", n+1)
}

func value(f float64) string {
	return fmt.Sprintf("%.2f", f)
}

templ ReportsPage(metric database.Metrics) {
	@layout() {
		<h5>Consult reports</h5>
		<select id="reports" name="reports-select" hx-get="/reports/select" hx-target="#reports-content">
			<option value="reports-select">Select a metric</option>
			for _, m := range metric {
				<option value={ fmt.Sprintf("%d", m.ID) }>{ m.Title }</option>
			}
		</select>
		<article id="reports-content">
			Please select a metric.
		</article>
		<style>
            .container {
                justify-content: center;
                align-items: center;
            }
            .item {margin: auto;}
        </style>
	}
}

templ Reports(entries database.Entries, diagram string) {
	<details>
		<summary>Entries</summary>
		<table>
			<thead>
				<tr>
					<th>#</th>
					<th>Date</th>
					<th>Value</th>
				</tr>
			</thead>
			<tbody>
				for i, entry := range entries {
					<tr>
						<td>{ counter(i) }</td>
						<td>{ entry.Date }</td>
						<td>{ value(entry.Value) }</td>
					</tr>
				}
			</tbody>
		</table>
	</details>
	<details>
		<summary>Diagram</summary>
		@templ.Raw(diagram)
	</details>
}
